---
import Layout from "../layouts/Layout.astro";

import { writeFile } from "fs/promises";
import path from "path";

if (Astro.request.method === "POST") {
  const formData = await Astro.request.formData();
  const file = formData.get("file") as File;
  const buffer = Buffer.from(await file.arrayBuffer());
  const filename = file.name;
  await writeFile(path.join(process.cwd(), "src/media", filename), buffer);
}
---

<Layout title="File">
  <h1>File</h1>
  <form method="POST" enctype="multipart/form-data">
    <input type="file" name="file" />
    <button type="submit">send</button>
  </form>
</Layout>
